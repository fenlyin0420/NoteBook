# 异常
![](Pasted%20image%2020240928150841.png)
异常可以由硬件触发，也可以由软件触发

## 中断(Interrupt)
顾名思义，就是程序在执行到一半的时候，被打断了。这个打断执行的信号，来自于CPU外部的I/O设备。  
你在键盘上按下一个按键，就会对应触发一个 相应的信号到达CPU里面。CPU里面某个开关的值发生了变化，也就触发了一个中断类型的异常。

## 陷阱(Trap)
程序员“故意“主动触发的异常。就好像你在程序里面打了一个断点，这个断点就是设下的一个"陷阱"。  

当程序的指令执行到这个位置的时候，就掉到了这个陷阱当中。然后，对应的异常处理程序就会来处理这个"陷阱"当中的猎物。

最常见的一类陷阱，应用程序调用系统调用的时候，也就是从用户态切换到内核态的时候。

> 可以用Linux下的time指令，去查看一个程序运行实际花费的时间，里面有在用户态花费的时间(user time)，也有在内核态发生的时间 (system time)。

应用程序通过系统调用去读取文件、创建进程，其实也是通过触发一次陷阱来进行的。这是因为用户态的应用程序没有权限来做这些事情，需要把对应的流程转交给有权限的异常处理程序来进行。

## 故障(Fault)
陷阱是我们开发程序的时候刻意触发的异常，而故障通常不是。  
比如，我们在程序执行的过程中，进行加法计算发生了溢出，其实就是故障类型的异常。  
这个异常不是我们在开发的时候计划内的，也一样需要有对应的异常处理程序去处理。

### 故障和陷阱、中断的重要区别
故障在异常程序处理完成之后，仍然回来处理当前的指 令，而不是去执行程序中的下一条指令。  
因为当前的指令因为故障的原因并没有成功执行完成。

## 中止(Abort)
与其说这是一种异常类型，不如说这是故障的一种特殊情况。 当CPU遇到了故障，但是恢复不过来的时候，程序就不得不中止了。